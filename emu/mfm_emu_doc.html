<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN" "http://www.w3.org/Math/DTD/mathml2/xhtml-math11-f.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><!--This file was converted to xhtml by LibreOffice - see http://cgit.freedesktop.org/libreoffice/core/tree/filter/source/xslt for the code.--><head profile="http://dublincore.org/documents/dcmi-terms/"><meta http-equiv="Content-Type" content="application/xhtml+xml; charset=utf-8"/><title xml:lang="en-US">- no title specified</title><meta name="DCTERMS.title" content="" xml:lang="en-US"/><meta name="DCTERMS.language" content="en-US" scheme="DCTERMS.RFC4646"/><meta name="DCTERMS.source" content="http://xml.openoffice.org/odf2xhtml"/><meta name="DCTERMS.creator" content="David Gesswein"/><meta name="DCTERMS.issued" content="2013-12-28T10:05:51" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.modified" content="2015-10-30T20:34:38.082593320" scheme="DCTERMS.W3CDTF"/><meta name="DCTERMS.provenance" content="" xml:lang="en-US"/><meta name="DCTERMS.subject" content="," xml:lang="en-US"/><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" hreflang="en"/><link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" hreflang="en"/><link rel="schema.DCTYPE" href="http://purl.org/dc/dcmitype/" hreflang="en"/><link rel="schema.DCAM" href="http://purl.org/dc/dcam/" hreflang="en"/><style type="text/css">
	@page {  }
	table { border-collapse:collapse; border-spacing:0; empty-cells:show }
	td, th { vertical-align:top; font-size:12pt;}
	h1, h2, h3, h4, h5, h6 { clear:both }
	ol, ul { margin:0; padding:0;}
	li { list-style: none; margin:0; padding:0;}
	<!-- "li span.odfLiEnd" - IE 7 issue-->
	li span. { clear: both; line-height:0; width:0; height:0; margin:0; padding:0; }
	span.footnodeNumber { padding-right:1em; }
	span.annotation_style_by_filter { font-size:95%; font-family:Arial; background-color:#fff000;  margin:0; border:0; padding:0;  }
	* { margin:0;}
	.P1 { font-size:12pt; font-family:Liberation Serif; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; }
	.P10 { font-size:12pt; font-family:Liberation Serif; writing-mode:page; margin-left:0.5in; margin-right:0in; text-indent:0in; background-color:transparent; }
	.P2 { font-size:12pt; font-family:Liberation Serif; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; font-style:italic; }
	.P3 { font-size:12pt; font-family:Liberation Serif; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; font-style:normal; }
	.P4 { font-size:12pt; font-family:Liberation Serif; writing-mode:page; margin-left:0in; margin-right:0in; text-indent:0in; }
	.P5 { font-size:12pt; font-family:Liberation Serif; writing-mode:page; margin-left:0.5in; margin-right:0in; text-indent:0in; }
	.P6 { font-size:12pt; font-family:Liberation Serif; writing-mode:page; margin-left:0.4925in; margin-right:0in; text-indent:0in; }
	.P7 { font-size:12pt; font-family:Liberation Serif; writing-mode:page; margin-left:0.4925in; margin-right:0in; text-indent:0in; }
	.P8 { font-size:12pt; font-family:Liberation Serif; writing-mode:page; margin-left:0.4925in; margin-right:0in; text-indent:0in; }
	.P9 { font-size:12pt; font-family:Liberation Serif; writing-mode:page; }
	.Standard { font-size:12pt; font-family:Liberation Serif; writing-mode:page; }
	.T1 { font-style:italic; }
	.T2 { font-style:italic; font-weight:bold; }
	<!-- ODF styles with no properties representable as CSS -->
	.T3 .T4 .T5  { }
	</style></head><body dir="ltr" style="max-width:8.5in;margin-top:0.7874in; margin-bottom:0.7874in; margin-left:0.7874in; margin-right:0.7874in; "><p class="Standard">mfm_emu emulates a MFM disk drive. It can use a data file created from a real drive by mfm_read or can create a empty emulation file.</p><p class="Standard"> </p><p class="P9">--begin_time -b #</p><p class="P7">The number of nanoseconds to delay from index to start reading track Only needed if initialize specified. <span class="T4">Default is zero if not specified.</span></p><p class="Standard">--cylinders  -c #</p><p class="P10">The number of cylinders. Only needed if initialize specified.</p><p class="P1">--drive  -d #[,#]</p><p class="P5">Drive number to emulate. <span class="T5">For revision B boards specify 0 or 1 or 1,2.</span> <span class="T5">Use </span>0 for drive to always be selected (radial select). <span class="T5">1 and 2 select the first and second jumper block to use for drive select. </span>One or two drive numbers may be specified to emulate one or two drives. Only one may be specified if drive number is 0. <span class="T5">For revision A boards specify the drive number to emulate 1-4.</span></p><p class="Standard">--file -f filename[,filename]</p><p class="P5">Emulation filename. First filename corresponds to first drive number specified.</p><p class="Standard">--heads  -h #</p><p class="P5">The number of heads. Only needed if initialize specified.</p><p class="P1">--initialize -i</p><p class="P5">If given create/overwrite specified file with empty data. Heads and cylinders must be specified.</p><p class="P1">--note -n “string”</p><p class="P5">Description to store in the emulation file. Only used if initialize specified.</p><p class="P1">--options -o “string”</p><p class="P6">Options for mfm_util in decoding such as –data_crc. This saves having to type each time you wish to decode file. Only used if initialize specified and not required. No validation is performed so use mfm_util to verify file is valid after creating.</p><p class="P4">--<span class="T3">pool</span> -<span class="T3">p</span> #,#.#</p><p class="P7">The first parameter is the <span class="T3">size of the</span> of track buffer <span class="T3">pool</span> to use. and the second is the maximum delay. The delay will increase linearly as the buffers fill to the maximum delay. Default is 75,0.6</p><p class="P9">--quiet  -q #h</p><p class="P5">Bit mask to select which messages don't print. 0 prints all messages. Default is 1 (no debug messages). Higher bits are more important messages in general.</p><p class="P1">--<span class="T3">rate -r #</span></p><p class="P8">Bit rate in Hz for the MFM clock and data bits. Only needed if initialize specified. Default is 10,000,000. <span class="T4">if not specified.</span> </p><p class="P1">--version -v</p><p class="P5">Print program version number.</p><p class="P1"> </p><p class="P1">Long options can be abbreviated to the shortest unique name. Long option values can't have spaces.</p><p class="P1"> </p><p class="P1"># is a number. #h is a number which may be decimal, octal if starts with a 0, or hex starting with 0x.</p><p class="P1"> </p><p class="P1">The buffer <span class="T3">pool</span> option controls buffering used to prevent controller timeouts when writing data to the file. Writing to flash has large delays at times which the buffers hide. The maximum delay should be set shorter than the controller timeout for a seek. The maximum number of buffers needs to be low enough that they can be written out before the holdup capacitors are drained.</p><p class="P1"> </p><p class="P4">Begin_time is for drives that have a sector straddle the start of the index pulse. For <span class="T3">emulation</span> to work properly all the data must be read consecutively. Set this parameter to the time in nanoseconds the first physical sector is delayed from the index pulse.  It is needed for Corvus model H and NorthStar Advantage drives.</p><p class="P4"> </p><p class="P1">When this program is run it appends to logfile.txt in the current directory. It logs when it started, stopped, how long it was executing,  maximum seek time, minimum free buffers, and how many seeks and writes were done. The shutdown time is from when the program was told to shut down to the emulation file closed and written to storage. The operating system will take about 5 more seconds to shut down.</p><p class="P1"> </p><p class="P1">If the log file minimum free buffers is zero you may wish to either increase the number of buffers or maximum delay. If the log file shutdown time is close to capacitor holdup time or not all the message were written to the log file the number of buffers should be decreased or wait 45 seconds after significant write activity before powering off the MFM emulator.</p><p class="P1">Example:</p><p class="P1">     mfm_emu –drive 1 –file disk_file</p><p class="P2">This used file disk_file to emulate a drive on select line 1.</p><p class="P2"> </p><p class="P3">    mfm_emu –drive 1 –file disk_file –initialize –cylinders 306 -heads 4 –note “Games disk” --options “--sectors 17,0 --heads 6 --cylinders 640 --header_crc 0x2605fb9c,0x104c981,32,0 --data_crc  0xd4d7ca20,0x104c981,32,0 --format OMTI_5510”</p><p class="P3"> </p><p class="P2">This creates/overwrites file disk_file with empty data for a disk with 306 cylinders and 4 heads. It then  emulates a drive on select line 1. You will need to use the host computer low level format program to write the sector headers before the emulated drive can be read or written normally.</p><p class="P2"> </p><p class="P1">Currently the program prints various stuff to see what it's doing. This will change as testing goes on.</p><p class="P1">bad pattern count 0 </p><p class="P1">Read queue underrun 0 </p><p class="P1">Write queue overrun 0 </p><p class="P1">Ecapture overrun 0 </p><p class="P1">glitch count 0 </p><p class="P1">glitch value 0 </p><p class="P1">0:test 0 0 </p><p class="P1">0:test 1 0 </p><p class="P1">0:test 2 0 </p><p class="P1">0:test 3 0 </p><p class="P1">0:test 4 0 </p><p class="P1">1:test 0 0 </p><p class="P1">1:test 1 0 </p><p class="P1">1:test 2 0 </p><p class="P1">1:test 3 0 </p><p class="P1">1:test 4 0 </p><p class="P1">    <span class="T1">The named values are various errors/unexpected conditions. The test values are used to show internal variables from the PRU's. See the source for current purpose.</span></p><p class="P1"> </p><p class="P1">select 0 head 0</p><p class="P2">   Current select and head line state</p><p class="P2"> </p><p class="P1">Waiting, seek time 3.9 ms max 3.9</p><p class="P1">   <span class="T1">IARM is waiting for PRU. The values are the last and maximum time from PRU requesting the next cylinder to the data being returned. </span><span class="T2">If seek time is zero you are using a buggy version of am335x_pru_package and data is likely to be corrupted.</span></p><p class="P2"> </p><p class="P1">Cyl 0,400 select 1, head 4 dirty 0</p><p class="P1">   <span class="T1">Last and next requested cylinder, select and head lines. Dirty 1 indicates the sector data was written to.</span></p><p class="P2"> </p><p class="P3">I have found that if unrecoverable read errors occur operating the drive in a different orientation may allow the data to be read. I have also had some luck especially on Seagate drives with pushing on the shaft of the head stepper motor while it is retrying. This seems to get the head at a slightly different position where it can read the data. This has a risk of drive damage so make sure you have read as much as you can before trying this.</p></body></html>